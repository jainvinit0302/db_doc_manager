{"csv":"target_db,target_schema,target_table,target_column,target_type,source_id,source_path,transform,default,mapping_rule,notes\ndw,mart,dim_product,sku,VARCHAR(64),mongo_products,$.sku,,,,\ndw,mart,dim_product,product_name,VARCHAR(256),mongo_products,$.name,trim(),,,\ndw,mart,dim_product,category,VARCHAR(128),mongo_products,$.category.name,upper(),,,\ndw,mart,dim_product,price,\"DECIMAL(10,2)\",mongo_products,$.price.amount,round(2),,,\ndw,mart,dim_product,product_id,INTEGER,,,,,sequence('dim_product_seq'),\ndw,mart,dim_customer,email,VARCHAR(320),mysql_customers,$.email,lower(),,,\ndw,mart,dim_customer,name,VARCHAR(256),mysql_customers,$.full_name,,,,\ndw,mart,dim_customer,signup_date,DATE,mysql_customers,$.created_on,,,,\ndw,mart,dim_customer,country,VARCHAR(64),mysql_customers,$.country,,,,\ndw,mart,dim_customer,customer_id,INTEGER,,,,,sequence('dim_customer_seq'),\ndw,mart,fact_sales,sale_id,BIGINT,mysql_orders,$.id,,,,\ndw,mart,fact_sales,product_id,INTEGER,mysql_orders,$.product_sku,\"lookup('dw.mart.dim_product', 'sku', 'product_id')\",,,\ndw,mart,fact_sales,customer_id,INTEGER,mysql_orders,$.customer_email,\"lookup('dw.mart.dim_customer', 'email', 'customer_id')\",,,\ndw,mart,fact_sales,quantity,INTEGER,mysql_orders,$.quantity,,,,\ndw,mart,fact_sales,total_amount,\"DECIMAL(12,2)\",mysql_orders,$.unit_price,multiply($.quantity),,,\ndw,mart,fact_sales,sale_date,DATE,mysql_orders,$.order_date,,,,","mermaids":[{"name":"erd_dw_mart.mmd","content":"erDiagram\n\n  dim_product {\n    product_id integer\n    sku varchar_64\n    product_name varchar_256\n    category varchar_128\n    price decimal_10_2\n    created_at timestamp\n  }\n\n  dim_customer {\n    customer_id integer\n    name varchar_256\n    email varchar_320\n    signup_date date\n    country varchar_64\n  }\n\n  fact_sales {\n    sale_id bigint\n    product_id integer\n    customer_id integer\n    quantity integer\n    total_amount decimal_12_2\n    sale_date date\n  }\n\n  %% Relationships\n  dim_product ||--o{ fact_sales : \"product_id\"\n  dim_customer ||--o{ fact_sales : \"customer_id\"\n\n"}],"lineage":{"nodes":[{"id":"src:mongo_products","type":"source","label":"mongo_products","meta":{"id":"mongo_products","kind":"mongodb","conn":"atlas-cluster-B","db":"inventory","collection":"products"}},{"id":"src:mysql_customers","type":"source","label":"mysql_customers","meta":{"id":"mysql_customers","kind":"mysql","conn":"crm-prod","db":"customer_db","table":"customers"}},{"id":"src:mysql_orders","type":"source","label":"mysql_orders","meta":{"id":"mysql_orders","kind":"mysql","conn":"sales-prod","db":"order_db","table":"orders"}},{"id":"t:dw.mart.dim_product","type":"table","label":"dw.mart.dim_product","meta":{"db":"dw","schema":"mart","table":"dim_product"}},{"id":"t:dw.mart.dim_product.product_id","type":"column","label":"product_id","meta":{"name":"product_id","type":"INTEGER","pk":true,"description":"Surrogate key","table":"dw.mart.dim_product"}},{"id":"t:dw.mart.dim_product.sku","type":"column","label":"sku","meta":{"name":"sku","type":"VARCHAR(64)","unique":true,"not_null":true,"table":"dw.mart.dim_product"}},{"id":"t:dw.mart.dim_product.product_name","type":"column","label":"product_name","meta":{"name":"product_name","type":"VARCHAR(256)","not_null":true,"table":"dw.mart.dim_product"}},{"id":"t:dw.mart.dim_product.category","type":"column","label":"category","meta":{"name":"category","type":"VARCHAR(128)","table":"dw.mart.dim_product"}},{"id":"t:dw.mart.dim_product.price","type":"column","label":"price","meta":{"name":"price","type":"DECIMAL(10,2)","table":"dw.mart.dim_product"}},{"id":"t:dw.mart.dim_product.created_at","type":"column","label":"created_at","meta":{"name":"created_at","type":"TIMESTAMP","default":"now()","table":"dw.mart.dim_product"}},{"id":"t:dw.mart.dim_customer","type":"table","label":"dw.mart.dim_customer","meta":{"db":"dw","schema":"mart","table":"dim_customer"}},{"id":"t:dw.mart.dim_customer.customer_id","type":"column","label":"customer_id","meta":{"name":"customer_id","type":"INTEGER","pk":true,"table":"dw.mart.dim_customer"}},{"id":"t:dw.mart.dim_customer.name","type":"column","label":"name","meta":{"name":"name","type":"VARCHAR(256)","table":"dw.mart.dim_customer"}},{"id":"t:dw.mart.dim_customer.email","type":"column","label":"email","meta":{"name":"email","type":"VARCHAR(320)","unique":true,"not_null":true,"table":"dw.mart.dim_customer"}},{"id":"t:dw.mart.dim_customer.signup_date","type":"column","label":"signup_date","meta":{"name":"signup_date","type":"DATE","table":"dw.mart.dim_customer"}},{"id":"t:dw.mart.dim_customer.country","type":"column","label":"country","meta":{"name":"country","type":"VARCHAR(64)","table":"dw.mart.dim_customer"}},{"id":"t:dw.mart.fact_sales","type":"table","label":"dw.mart.fact_sales","meta":{"db":"dw","schema":"mart","table":"fact_sales"}},{"id":"t:dw.mart.fact_sales.sale_id","type":"column","label":"sale_id","meta":{"name":"sale_id","type":"BIGINT","pk":true,"table":"dw.mart.fact_sales"}},{"id":"t:dw.mart.fact_sales.product_id","type":"column","label":"product_id","meta":{"name":"product_id","type":"INTEGER","fk":{"table":"dim_product","column":"product_id"},"table":"dw.mart.fact_sales"}},{"id":"t:dw.mart.fact_sales.customer_id","type":"column","label":"customer_id","meta":{"name":"customer_id","type":"INTEGER","fk":{"table":"dim_customer","column":"customer_id"},"table":"dw.mart.fact_sales"}},{"id":"t:dw.mart.fact_sales.quantity","type":"column","label":"quantity","meta":{"name":"quantity","type":"INTEGER","table":"dw.mart.fact_sales"}},{"id":"t:dw.mart.fact_sales.total_amount","type":"column","label":"total_amount","meta":{"name":"total_amount","type":"DECIMAL(12,2)","table":"dw.mart.fact_sales"}},{"id":"t:dw.mart.fact_sales.sale_date","type":"column","label":"sale_date","meta":{"name":"sale_date","type":"DATE","table":"dw.mart.fact_sales"}},{"id":"src:mongo_products:$.sku","type":"source_column","label":"$.sku","meta":{"source_id":"mongo_products","path":"$.sku"}},{"id":"src:mongo_products:$.name","type":"source_column","label":"$.name","meta":{"source_id":"mongo_products","path":"$.name"}},{"id":"src:mongo_products:$.category.name","type":"source_column","label":"$.category.name","meta":{"source_id":"mongo_products","path":"$.category.name"}},{"id":"src:mongo_products:$.price.amount","type":"source_column","label":"$.price.amount","meta":{"source_id":"mongo_products","path":"$.price.amount"}},{"id":"rule:sequence('dim_product_seq')","type":"rule","label":"sequence('dim_product_seq')","meta":{"rule":"sequence('dim_product_seq')"}},{"id":"src:mysql_customers:$.email","type":"source_column","label":"$.email","meta":{"source_id":"mysql_customers","path":"$.email"}},{"id":"src:mysql_customers:$.full_name","type":"source_column","label":"$.full_name","meta":{"source_id":"mysql_customers","path":"$.full_name"}},{"id":"src:mysql_customers:$.created_on","type":"source_column","label":"$.created_on","meta":{"source_id":"mysql_customers","path":"$.created_on"}},{"id":"src:mysql_customers:$.country","type":"source_column","label":"$.country","meta":{"source_id":"mysql_customers","path":"$.country"}},{"id":"rule:sequence('dim_customer_seq')","type":"rule","label":"sequence('dim_customer_seq')","meta":{"rule":"sequence('dim_customer_seq')"}},{"id":"src:mysql_orders:$.id","type":"source_column","label":"$.id","meta":{"source_id":"mysql_orders","path":"$.id"}},{"id":"src:mysql_orders:$.product_sku","type":"source_column","label":"$.product_sku","meta":{"source_id":"mysql_orders","path":"$.product_sku"}},{"id":"src:mysql_orders:$.customer_email","type":"source_column","label":"$.customer_email","meta":{"source_id":"mysql_orders","path":"$.customer_email"}},{"id":"src:mysql_orders:$.quantity","type":"source_column","label":"$.quantity","meta":{"source_id":"mysql_orders","path":"$.quantity"}},{"id":"src:mysql_orders:$.unit_price","type":"source_column","label":"$.unit_price","meta":{"source_id":"mysql_orders","path":"$.unit_price"}},{"id":"src:mysql_orders:$.order_date","type":"source_column","label":"$.order_date","meta":{"source_id":"mysql_orders","path":"$.order_date"}}],"edges":[{"id":"e1","source":"src:mongo_products:$.sku","target":"t:dw.mart.dim_product.sku","type":"column_lineage","meta":{"transform":null,"rule":null,"raw":"dw.mart.dim_product.sku"}},{"id":"e2","source":"src:mongo_products:$.name","target":"t:dw.mart.dim_product.product_name","type":"column_lineage","meta":{"transform":"trim()","rule":null,"raw":"dw.mart.dim_product.product_name"}},{"id":"e3","source":"src:mongo_products:$.category.name","target":"t:dw.mart.dim_product.category","type":"column_lineage","meta":{"transform":"upper()","rule":null,"raw":"dw.mart.dim_product.category"}},{"id":"e4","source":"src:mongo_products:$.price.amount","target":"t:dw.mart.dim_product.price","type":"column_lineage","meta":{"transform":"round(2)","rule":null,"raw":"dw.mart.dim_product.price"}},{"id":"e5","source":"rule:sequence('dim_product_seq')","target":"t:dw.mart.dim_product.product_id","type":"column_lineage","meta":{"rule":"sequence('dim_product_seq')"}},{"id":"e6","source":"src:mysql_customers:$.email","target":"t:dw.mart.dim_customer.email","type":"column_lineage","meta":{"transform":"lower()","rule":null,"raw":"dw.mart.dim_customer.email"}},{"id":"e7","source":"src:mysql_customers:$.full_name","target":"t:dw.mart.dim_customer.name","type":"column_lineage","meta":{"transform":null,"rule":null,"raw":"dw.mart.dim_customer.name"}},{"id":"e8","source":"src:mysql_customers:$.created_on","target":"t:dw.mart.dim_customer.signup_date","type":"column_lineage","meta":{"transform":null,"rule":null,"raw":"dw.mart.dim_customer.signup_date"}},{"id":"e9","source":"src:mysql_customers:$.country","target":"t:dw.mart.dim_customer.country","type":"column_lineage","meta":{"transform":null,"rule":null,"raw":"dw.mart.dim_customer.country"}},{"id":"e10","source":"rule:sequence('dim_customer_seq')","target":"t:dw.mart.dim_customer.customer_id","type":"column_lineage","meta":{"rule":"sequence('dim_customer_seq')"}},{"id":"e11","source":"src:mysql_orders:$.id","target":"t:dw.mart.fact_sales.sale_id","type":"column_lineage","meta":{"transform":null,"rule":null,"raw":"dw.mart.fact_sales.sale_id"}},{"id":"e12","source":"src:mysql_orders:$.product_sku","target":"t:dw.mart.fact_sales.product_id","type":"column_lineage","meta":{"transform":"lookup('dw.mart.dim_product', 'sku', 'product_id')","rule":null,"raw":"dw.mart.fact_sales.product_id"}},{"id":"e13","source":"src:mysql_orders:$.customer_email","target":"t:dw.mart.fact_sales.customer_id","type":"column_lineage","meta":{"transform":"lookup('dw.mart.dim_customer', 'email', 'customer_id')","rule":null,"raw":"dw.mart.fact_sales.customer_id"}},{"id":"e14","source":"src:mysql_orders:$.quantity","target":"t:dw.mart.fact_sales.quantity","type":"column_lineage","meta":{"transform":null,"rule":null,"raw":"dw.mart.fact_sales.quantity"}},{"id":"e15","source":"src:mysql_orders:$.unit_price","target":"t:dw.mart.fact_sales.total_amount","type":"column_lineage","meta":{"transform":"multiply($.quantity)","rule":null,"raw":"dw.mart.fact_sales.total_amount"}},{"id":"e16","source":"src:mysql_orders:$.order_date","target":"t:dw.mart.fact_sales.sale_date","type":"column_lineage","meta":{"transform":null,"rule":null,"raw":"dw.mart.fact_sales.sale_date"}}],"table_edges":[{"id":"te1","source":"src:mongo_products","target":"t:dw.mart.dim_product","meta":{"columns":["sku","product_name","category","price"]}},{"id":"te2","source":"rule:sequence('dim_product_seq')","target":"t:dw.mart.dim_product","meta":{"columns":["product_id"]}},{"id":"te3","source":"src:mysql_customers","target":"t:dw.mart.dim_customer","meta":{"columns":["email","name","signup_date","country"]}},{"id":"te4","source":"rule:sequence('dim_customer_seq')","target":"t:dw.mart.dim_customer","meta":{"columns":["customer_id"]}},{"id":"te5","source":"src:mysql_orders","target":"t:dw.mart.fact_sales","meta":{"columns":["sale_id","product_id","customer_id","quantity","total_amount","sale_date"]}}]},"sql":{"sql":"CREATE TABLE IF NOT EXISTS dw.mart.dim_customer (\n  customer_id INTEGER PRIMARY KEY,\n  name VARCHAR(256),\n  email VARCHAR(320) UNIQUE NOT NULL,\n  signup_date DATE,\n  country VARCHAR(64)\n);\n\nCREATE TABLE IF NOT EXISTS dw.mart.dim_product (\n  product_id INTEGER PRIMARY KEY,\n  sku VARCHAR(64) UNIQUE NOT NULL,\n  product_name VARCHAR(256) NOT NULL,\n  category VARCHAR(128),\n  price DECIMAL(10,2),\n  created_at TIMESTAMP DEFAULT now()\n);\n\nCREATE TABLE IF NOT EXISTS dw.mart.fact_sales (\n  sale_id BIGINT PRIMARY KEY,\n  product_id INTEGER REFERENCES dw.mart.dim_product(product_id),\n  customer_id INTEGER REFERENCES dw.mart.dim_customer(customer_id),\n  quantity INTEGER,\n  total_amount DECIMAL(12,2),\n  sale_date DATE\n);","postgres":"CREATE TABLE IF NOT EXISTS dw.mart.dim_customer (\n  customer_id INTEGER PRIMARY KEY,\n  name VARCHAR(256),\n  email VARCHAR(320) UNIQUE NOT NULL,\n  signup_date DATE,\n  country VARCHAR(64)\n);\n\nCREATE TABLE IF NOT EXISTS dw.mart.dim_product (\n  product_id INTEGER PRIMARY KEY,\n  sku VARCHAR(64) UNIQUE NOT NULL,\n  product_name VARCHAR(256) NOT NULL,\n  category VARCHAR(128),\n  price DECIMAL(10,2),\n  created_at TIMESTAMP DEFAULT now()\n);\n\nCREATE TABLE IF NOT EXISTS dw.mart.fact_sales (\n  sale_id BIGINT PRIMARY KEY,\n  product_id INTEGER REFERENCES dw.mart.dim_product(product_id),\n  customer_id INTEGER REFERENCES dw.mart.dim_customer(customer_id),\n  quantity INTEGER,\n  total_amount DECIMAL(12,2),\n  sale_date DATE\n);","snowflake":"CREATE OR REPLACE TABLE dw.mart.dim_customer (\n  customer_id INTEGER,\n  name STRING,\n  email STRING UNIQUE NOT NULL,\n  signup_date DATE,\n  country STRING,\n  PRIMARY KEY (customer_id)\n);\n\nCREATE OR REPLACE TABLE dw.mart.dim_product (\n  product_id INTEGER,\n  sku STRING UNIQUE NOT NULL,\n  product_name STRING NOT NULL,\n  category STRING,\n  price NUMBER(10,2),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP(),\n  PRIMARY KEY (product_id)\n);\n\nCREATE OR REPLACE TABLE dw.mart.fact_sales (\n  sale_id BIGINT,\n  product_id INTEGER,\n  customer_id INTEGER,\n  quantity INTEGER,\n  total_amount NUMBER(12,2),\n  sale_date DATE,\n  PRIMARY KEY (sale_id)\n);","mongodb":"// MongoDB Schema Validation Script\n\n// Run this in mongosh or a driver\n\ndb.createCollection(\"dim_customer\", {\n  validator: {\n    $jsonSchema: {\n      bsonType: \"object\",\n      required: [\"customer_id\", \"email\"],\n      properties: {\n        customer_id: { bsonType: \"int\" },\n        name: { bsonType: [\"string\",\"null\"] },\n        email: { bsonType: \"string\" },\n        signup_date: { bsonType: [\"date\",\"null\"] },\n        country: { bsonType: [\"string\",\"null\"] },\n      }\n    }\n  }\n});\n\ndb.createCollection(\"dim_product\", {\n  validator: {\n    $jsonSchema: {\n      bsonType: \"object\",\n      required: [\"product_id\", \"sku\", \"product_name\"],\n      properties: {\n        product_id: { bsonType: \"int\" },\n        sku: { bsonType: \"string\" },\n        product_name: { bsonType: \"string\" },\n        category: { bsonType: [\"string\",\"null\"] },\n        price: { bsonType: [\"double\",\"decimal\",\"null\"] },\n        created_at: { bsonType: [\"date\",\"null\"] },\n      }\n    }\n  }\n});\n\ndb.createCollection(\"fact_sales\", {\n  validator: {\n    $jsonSchema: {\n      bsonType: \"object\",\n      required: [\"sale_id\"],\n      properties: {\n        sale_id: { bsonType: \"long\" },\n        product_id: { bsonType: [\"int\",\"null\"] },\n        customer_id: { bsonType: [\"int\",\"null\"] },\n        quantity: { bsonType: [\"int\",\"null\"] },\n        total_amount: { bsonType: [\"double\",\"decimal\",\"null\"] },\n        sale_date: { bsonType: [\"date\",\"null\"] },\n      }\n    }\n  }\n});"},"referentialWarnings":[]}