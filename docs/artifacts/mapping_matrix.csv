target_db,target_schema,target_table,target_column,target_type,source_id,source_path,transform,default,mapping_rule,notes
dw,dim,dim_customer,customer_id,STRING,mongo_customers,$.id,,,,
dw,dim,dim_customer,first_name,STRING,mongo_customers,$.profile.name.first,,,,
dw,dim,dim_customer,last_name,STRING,mongo_customers,$.profile.name.last,,,,
dw,dim,dim_customer,email,STRING,mongo_customers,$.contacts.emails[0],,,,
dw,dim,dim_customer,phone,STRING,mongo_customers,$.contacts.phone.primary,,,,
dw,dim,dim_customer,country_code,STRING,mongo_customers,$.location.country_code,,,,
dw,dim,dim_customer,customer_sk,BIGINT,,,,,sequence('seq_customer_master'),
dw,dim,dim_product,product_id,STRING,event_file,$.payload.product.id,,,,
dw,dim,dim_product,name,STRING,event_file,$.payload.product.title,,,,
dw,dim,dim_product,category,STRING,event_file,$.payload.product.category,,,,
dw,dim,dim_product,brand,STRING,event_file,$.payload.product.brand,,,,
dw,dim,dim_product,product_sk,BIGINT,,,,,sequence('seq_product_master'),
dw,fact,fct_order,order_id,STRING,mysql_orders,$.order_id,,,,
dw,fact,fct_order,order_amount,DECIMAL(14,mysql_orders,$.total_amount,,,,
dw,fact,fct_order,currency,STRING,mysql_orders,$.currency,,,,
dw,fact,fct_order,order_ts,TIMESTAMP,mysql_orders,$.created_at,,,,
dw,fact,fct_order,payment_type,STRING,mysql_orders,$.payment_method,,,,
dw,fact,fct_order,is_chargeback,BOOLEAN,mysql_orders,$.chargeback_flag,,,,
dw,fact,fct_order,order_sk,BIGINT,,,,,uuid(),
dw,fact,fct_order,customer_sk,BIGINT,,,,,"lookup_surrogate('dim_customer', mysql_orders.customer_id)",
dw,fact,fct_order,product_sk,BIGINT,,,,,"lookup_surrogate('dim_product', mysql_orders.product_id)",
analytics,curated,txn_enriched_v2,order_id,STRING,mysql_orders,$.order_id,,,,
analytics,curated,txn_enriched_v2,customer_id,STRING,mysql_orders,$.customer_id,,,,
analytics,curated,txn_enriched_v2,product_id,STRING,mysql_orders,$.product_id,,,,
analytics,curated,txn_enriched_v2,local_currency,STRING,mysql_orders,$.currency,,,,
analytics,curated,txn_enriched_v2,region,STRING,mongo_customers,$.location.region,,,,
analytics,curated,txn_enriched_v2,loyalty_tier,STRING,mongo_customers,$.loyalty.tier,,,,
analytics,curated,txn_enriched_v2,source_system,STRING,event_file,$.payload.source.system,,,,
analytics,curated,txn_enriched_v2,ingest_origin,STRING,event_file,$.payload.metadata.origin,,,,
analytics,curated,txn_enriched_v2,is_high_value,BOOLEAN,,,,,"greaterThan(mysql_orders.total_amount, 1000)",
analytics,curated,txn_enriched_v2,amount_usd,FLOAT,,,,,"convert_to_usd(mysql_orders.total_amount, lookup_rate(mysql_orders.currency, 'refdb.fx_rates'))",
analytics,curated,txn_enriched_v2,ingestion_ts,TIMESTAMP,,,,,now(),
refdb,ref,fx_rates,currency,STRING,mysql_ref,$.currency,,,,
refdb,ref,fx_rates,usd_rate,FLOAT,mysql_ref,$.usd_rate,,,,
refdb,ref,fx_rates,as_of_ts,TIMESTAMP,mysql_ref,$.as_of_ts,,,,
dw,dim,dim_product,created_at,TIMESTAMP,snowflake_catalog,$.system_timestamp,,,,