target_db,target_schema,target_table,target_column,target_type,source_id,source_path,transform,default,mapping_rule,notes
dw,dim,dim_stage_01,id,STRING,src_root,$.id,,,,
dw,dim,dim_stage_01,v1,STRING,src_root,$.value_v1,,,,
dw,dim,dim_stage_02,id,STRING,,,,,"lookup('dim_stage_01.id', src_root.id)",
dw,dim,dim_stage_02,v2,STRING,,,,,"transform_upper(lookup('dim_stage_01.v1', src_root.id))",
dw,dim,dim_stage_03,id,STRING,,,,,"lookup('dim_stage_02.id', src_root.id)",
dw,dim,dim_stage_03,v3,STRING,,,,,"concat(lookup('dim_stage_02.v2', src_root.id),'_x')",
dw,dim,dim_stage_04,id,STRING,,,,,"lookup('dim_stage_03.id', src_root.id)",
dw,dim,dim_stage_04,v4,STRING,,,,,"hash(lookup('dim_stage_03.v3', src_root.id))",
dw,dim,dim_stage_05,id,STRING,,,,,"lookup('dim_stage_04.id', src_root.id)",
dw,dim,dim_stage_05,v5,STRING,,,,,"concat(lookup('dim_stage_04.v4', src_root.id),'_end')",
analytics,curated,final_chain,id,STRING,,,,,"lookup('dim_stage_05.id', src_root.id)",
analytics,curated,final_chain,final_value,STRING,,,,,"concat(lookup('dim_stage_05.v5', src_root.id),'|', src_root.meta.tag)",
analytics,curated,final_chain,chain_depth,INTEGER,,,,,constant(5),