{
  "nodes": [
    {
      "id": "src:src_root",
      "type": "source",
      "label": "src_root",
      "meta": {
        "id": "src_root",
        "kind": "mongodb",
        "conn": "atlas",
        "db": "raw",
        "collection": "root"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_01",
      "type": "table",
      "label": "dw.dim.dim_stage_01",
      "meta": {
        "db": "dw",
        "schema": "dim",
        "table": "dim_stage_01"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_01.id",
      "type": "column",
      "label": "id",
      "meta": {
        "name": "id",
        "type": "STRING",
        "pk": true,
        "table": "dw.dim.dim_stage_01"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_01.v1",
      "type": "column",
      "label": "v1",
      "meta": {
        "name": "v1",
        "type": "STRING",
        "table": "dw.dim.dim_stage_01"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_02",
      "type": "table",
      "label": "dw.dim.dim_stage_02",
      "meta": {
        "db": "dw",
        "schema": "dim",
        "table": "dim_stage_02"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_02.id",
      "type": "column",
      "label": "id",
      "meta": {
        "name": "id",
        "type": "STRING",
        "pk": true,
        "table": "dw.dim.dim_stage_02"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_02.v2",
      "type": "column",
      "label": "v2",
      "meta": {
        "name": "v2",
        "type": "STRING",
        "table": "dw.dim.dim_stage_02"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_03",
      "type": "table",
      "label": "dw.dim.dim_stage_03",
      "meta": {
        "db": "dw",
        "schema": "dim",
        "table": "dim_stage_03"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_03.id",
      "type": "column",
      "label": "id",
      "meta": {
        "name": "id",
        "type": "STRING",
        "pk": true,
        "table": "dw.dim.dim_stage_03"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_03.v3",
      "type": "column",
      "label": "v3",
      "meta": {
        "name": "v3",
        "type": "STRING",
        "table": "dw.dim.dim_stage_03"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_04",
      "type": "table",
      "label": "dw.dim.dim_stage_04",
      "meta": {
        "db": "dw",
        "schema": "dim",
        "table": "dim_stage_04"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_04.id",
      "type": "column",
      "label": "id",
      "meta": {
        "name": "id",
        "type": "STRING",
        "pk": true,
        "table": "dw.dim.dim_stage_04"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_04.v4",
      "type": "column",
      "label": "v4",
      "meta": {
        "name": "v4",
        "type": "STRING",
        "table": "dw.dim.dim_stage_04"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_05",
      "type": "table",
      "label": "dw.dim.dim_stage_05",
      "meta": {
        "db": "dw",
        "schema": "dim",
        "table": "dim_stage_05"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_05.id",
      "type": "column",
      "label": "id",
      "meta": {
        "name": "id",
        "type": "STRING",
        "pk": true,
        "table": "dw.dim.dim_stage_05"
      }
    },
    {
      "id": "t:dw.dim.dim_stage_05.v5",
      "type": "column",
      "label": "v5",
      "meta": {
        "name": "v5",
        "type": "STRING",
        "table": "dw.dim.dim_stage_05"
      }
    },
    {
      "id": "t:analytics.curated.final_chain",
      "type": "table",
      "label": "analytics.curated.final_chain",
      "meta": {
        "db": "analytics",
        "schema": "curated",
        "table": "final_chain"
      }
    },
    {
      "id": "t:analytics.curated.final_chain.id",
      "type": "column",
      "label": "id",
      "meta": {
        "name": "id",
        "type": "STRING",
        "table": "analytics.curated.final_chain"
      }
    },
    {
      "id": "t:analytics.curated.final_chain.final_value",
      "type": "column",
      "label": "final_value",
      "meta": {
        "name": "final_value",
        "type": "STRING",
        "table": "analytics.curated.final_chain"
      }
    },
    {
      "id": "t:analytics.curated.final_chain.chain_depth",
      "type": "column",
      "label": "chain_depth",
      "meta": {
        "name": "chain_depth",
        "type": "INTEGER",
        "table": "analytics.curated.final_chain"
      }
    },
    {
      "id": "src:src_root:$.id",
      "type": "source_column",
      "label": "$.id",
      "meta": {
        "source_id": "src_root",
        "path": "$.id"
      }
    },
    {
      "id": "src:src_root:$.value_v1",
      "type": "source_column",
      "label": "$.value_v1",
      "meta": {
        "source_id": "src_root",
        "path": "$.value_v1"
      }
    },
    {
      "id": "rule:lookup('dim_stage_01.id', src_root.id)",
      "type": "rule",
      "label": "lookup('dim_stage_01.id', src_root.id)",
      "meta": {
        "rule": "lookup('dim_stage_01.id', src_root.id)"
      }
    },
    {
      "id": "rule:transform_upper(lookup('dim_stage_01.v1', src_root.id))",
      "type": "rule",
      "label": "transform_upper(lookup('dim_stage_01.v1', src_root.id))",
      "meta": {
        "rule": "transform_upper(lookup('dim_stage_01.v1', src_root.id))"
      }
    },
    {
      "id": "rule:lookup('dim_stage_02.id', src_root.id)",
      "type": "rule",
      "label": "lookup('dim_stage_02.id', src_root.id)",
      "meta": {
        "rule": "lookup('dim_stage_02.id', src_root.id)"
      }
    },
    {
      "id": "rule:concat(lookup('dim_stage_02.v2', src_root.id),'_x')",
      "type": "rule",
      "label": "concat(lookup('dim_stage_02.v2', src_root.id),'_x')",
      "meta": {
        "rule": "concat(lookup('dim_stage_02.v2', src_root.id),'_x')"
      }
    },
    {
      "id": "rule:lookup('dim_stage_03.id', src_root.id)",
      "type": "rule",
      "label": "lookup('dim_stage_03.id', src_root.id)",
      "meta": {
        "rule": "lookup('dim_stage_03.id', src_root.id)"
      }
    },
    {
      "id": "rule:hash(lookup('dim_stage_03.v3', src_root.id))",
      "type": "rule",
      "label": "hash(lookup('dim_stage_03.v3', src_root.id))",
      "meta": {
        "rule": "hash(lookup('dim_stage_03.v3', src_root.id))"
      }
    },
    {
      "id": "rule:lookup('dim_stage_04.id', src_root.id)",
      "type": "rule",
      "label": "lookup('dim_stage_04.id', src_root.id)",
      "meta": {
        "rule": "lookup('dim_stage_04.id', src_root.id)"
      }
    },
    {
      "id": "rule:concat(lookup('dim_stage_04.v4', src_root.id),'_end')",
      "type": "rule",
      "label": "concat(lookup('dim_stage_04.v4', src_root.id),'_end')",
      "meta": {
        "rule": "concat(lookup('dim_stage_04.v4', src_root.id),'_end')"
      }
    },
    {
      "id": "rule:lookup('dim_stage_05.id', src_root.id)",
      "type": "rule",
      "label": "lookup('dim_stage_05.id', src_root.id)",
      "meta": {
        "rule": "lookup('dim_stage_05.id', src_root.id)"
      }
    },
    {
      "id": "rule:concat(lookup('dim_stage_05.v5', src_root.id),'|', src_root.meta.tag)",
      "type": "rule",
      "label": "concat(lookup('dim_stage_05.v5', src_root.id),'|', src_root.meta.tag)",
      "meta": {
        "rule": "concat(lookup('dim_stage_05.v5', src_root.id),'|', src_root.meta.tag)"
      }
    },
    {
      "id": "rule:constant(5)",
      "type": "rule",
      "label": "constant(5)",
      "meta": {
        "rule": "constant(5)"
      }
    }
  ],
  "edges": [
    {
      "id": "e1",
      "source": "src:src_root:$.id",
      "target": "t:dw.dim.dim_stage_01.id",
      "type": "column_lineage",
      "meta": {
        "transform": null,
        "rule": null,
        "raw": "dw.dim.dim_stage_01.id"
      }
    },
    {
      "id": "e2",
      "source": "src:src_root:$.value_v1",
      "target": "t:dw.dim.dim_stage_01.v1",
      "type": "column_lineage",
      "meta": {
        "transform": null,
        "rule": null,
        "raw": "dw.dim.dim_stage_01.v1"
      }
    },
    {
      "id": "e3",
      "source": "rule:lookup('dim_stage_01.id', src_root.id)",
      "target": "t:dw.dim.dim_stage_02.id",
      "type": "column_lineage",
      "meta": {
        "rule": "lookup('dim_stage_01.id', src_root.id)"
      }
    },
    {
      "id": "e4",
      "source": "rule:transform_upper(lookup('dim_stage_01.v1', src_root.id))",
      "target": "t:dw.dim.dim_stage_02.v2",
      "type": "column_lineage",
      "meta": {
        "rule": "transform_upper(lookup('dim_stage_01.v1', src_root.id))"
      }
    },
    {
      "id": "e5",
      "source": "rule:lookup('dim_stage_02.id', src_root.id)",
      "target": "t:dw.dim.dim_stage_03.id",
      "type": "column_lineage",
      "meta": {
        "rule": "lookup('dim_stage_02.id', src_root.id)"
      }
    },
    {
      "id": "e6",
      "source": "rule:concat(lookup('dim_stage_02.v2', src_root.id),'_x')",
      "target": "t:dw.dim.dim_stage_03.v3",
      "type": "column_lineage",
      "meta": {
        "rule": "concat(lookup('dim_stage_02.v2', src_root.id),'_x')"
      }
    },
    {
      "id": "e7",
      "source": "rule:lookup('dim_stage_03.id', src_root.id)",
      "target": "t:dw.dim.dim_stage_04.id",
      "type": "column_lineage",
      "meta": {
        "rule": "lookup('dim_stage_03.id', src_root.id)"
      }
    },
    {
      "id": "e8",
      "source": "rule:hash(lookup('dim_stage_03.v3', src_root.id))",
      "target": "t:dw.dim.dim_stage_04.v4",
      "type": "column_lineage",
      "meta": {
        "rule": "hash(lookup('dim_stage_03.v3', src_root.id))"
      }
    },
    {
      "id": "e9",
      "source": "rule:lookup('dim_stage_04.id', src_root.id)",
      "target": "t:dw.dim.dim_stage_05.id",
      "type": "column_lineage",
      "meta": {
        "rule": "lookup('dim_stage_04.id', src_root.id)"
      }
    },
    {
      "id": "e10",
      "source": "rule:concat(lookup('dim_stage_04.v4', src_root.id),'_end')",
      "target": "t:dw.dim.dim_stage_05.v5",
      "type": "column_lineage",
      "meta": {
        "rule": "concat(lookup('dim_stage_04.v4', src_root.id),'_end')"
      }
    },
    {
      "id": "e11",
      "source": "rule:lookup('dim_stage_05.id', src_root.id)",
      "target": "t:analytics.curated.final_chain.id",
      "type": "column_lineage",
      "meta": {
        "rule": "lookup('dim_stage_05.id', src_root.id)"
      }
    },
    {
      "id": "e12",
      "source": "rule:concat(lookup('dim_stage_05.v5', src_root.id),'|', src_root.meta.tag)",
      "target": "t:analytics.curated.final_chain.final_value",
      "type": "column_lineage",
      "meta": {
        "rule": "concat(lookup('dim_stage_05.v5', src_root.id),'|', src_root.meta.tag)"
      }
    },
    {
      "id": "e13",
      "source": "rule:constant(5)",
      "target": "t:analytics.curated.final_chain.chain_depth",
      "type": "column_lineage",
      "meta": {
        "rule": "constant(5)"
      }
    }
  ],
  "table_edges": [
    {
      "id": "te1",
      "source": "src:src_root",
      "target": "t:dw.dim.dim_stage_01",
      "meta": {
        "columns": [
          "id",
          "v1"
        ]
      }
    },
    {
      "id": "te2",
      "source": "rule:lookup('dim_stage_01.id', src_root.id)",
      "target": "t:dw.dim.dim_stage_02",
      "meta": {
        "columns": [
          "id"
        ]
      }
    },
    {
      "id": "te3",
      "source": "rule:transform_upper(lookup('dim_stage_01.v1', src_root.id))",
      "target": "t:dw.dim.dim_stage_02",
      "meta": {
        "columns": [
          "v2"
        ]
      }
    },
    {
      "id": "te4",
      "source": "rule:lookup('dim_stage_02.id', src_root.id)",
      "target": "t:dw.dim.dim_stage_03",
      "meta": {
        "columns": [
          "id"
        ]
      }
    },
    {
      "id": "te5",
      "source": "rule:concat(lookup('dim_stage_02.v2', src_root.id),'_x')",
      "target": "t:dw.dim.dim_stage_03",
      "meta": {
        "columns": [
          "v3"
        ]
      }
    },
    {
      "id": "te6",
      "source": "rule:lookup('dim_stage_03.id', src_root.id)",
      "target": "t:dw.dim.dim_stage_04",
      "meta": {
        "columns": [
          "id"
        ]
      }
    },
    {
      "id": "te7",
      "source": "rule:hash(lookup('dim_stage_03.v3', src_root.id))",
      "target": "t:dw.dim.dim_stage_04",
      "meta": {
        "columns": [
          "v4"
        ]
      }
    },
    {
      "id": "te8",
      "source": "rule:lookup('dim_stage_04.id', src_root.id)",
      "target": "t:dw.dim.dim_stage_05",
      "meta": {
        "columns": [
          "id"
        ]
      }
    },
    {
      "id": "te9",
      "source": "rule:concat(lookup('dim_stage_04.v4', src_root.id),'_end')",
      "target": "t:dw.dim.dim_stage_05",
      "meta": {
        "columns": [
          "v5"
        ]
      }
    },
    {
      "id": "te10",
      "source": "rule:lookup('dim_stage_05.id', src_root.id)",
      "target": "t:analytics.curated.final_chain",
      "meta": {
        "columns": [
          "id"
        ]
      }
    },
    {
      "id": "te11",
      "source": "rule:concat(lookup('dim_stage_05.v5', src_root.id),'",
      "target": "', src_root.meta.tag)",
      "meta": {
        "columns": [
          "final_value"
        ]
      }
    },
    {
      "id": "te12",
      "source": "rule:constant(5)",
      "target": "t:analytics.curated.final_chain",
      "meta": {
        "columns": [
          "chain_depth"
        ]
      }
    }
  ]
}